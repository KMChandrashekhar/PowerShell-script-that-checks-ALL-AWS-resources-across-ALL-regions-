$regionsText = aws ec2 describe-regions --query "Regions[].RegionName" --output text
$regions = $regionsText -split "\s+"

foreach ($region in $regions) {

    Write-Host "====== Checking region: $region ======" -ForegroundColor Cyan

    Write-Host "--- EC2 Instances ---"
    aws ec2 describe-instances --region $region --query "Reservations[].Instances[].InstanceId"

    Write-Host "--- EBS Volumes ---"
    aws ec2 describe-volumes --region $region --query "Volumes[].{ID:VolumeId,State:State}"

    Write-Host "--- Snapshots ---"
    aws ec2 describe-snapshots --owner-ids self --region $region --query "Snapshots[].SnapshotId"

    Write-Host "--- Elastic IPs ---"
    aws ec2 describe-addresses --region $region --query "Addresses[].PublicIp"

    Write-Host "--- NAT Gateways ---"
    aws ec2 describe-nat-gateways --region $region --query "NatGateways[].NatGatewayId"

    Write-Host "--- Load Balancers ---"
    aws elbv2 describe-load-balancers --region $region --query "LoadBalancers[].LoadBalancerArn"

    Write-Host "--- RDS Instances ---"
    aws rds describe-db-instances --region $region --query "DBInstances[].DBInstanceIdentifier"

    Write-Host "--- Lambda Functions ---"
    aws lambda list-functions --region $region --query "Functions[].FunctionName"

    Write-Host "--- VPC Endpoints ---"
    aws ec2 describe-vpc-endpoints --region $region --query "VpcEndpoints[].VpcEndpointId"

    Write-Host "`n"
}
